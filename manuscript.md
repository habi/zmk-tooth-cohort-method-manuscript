---
author-meta:
- "David Haberth\xFCr"
- Ruslan Hlushchuk
- Thomas Gerhard Wolf
bibliography:
- content/manual-references.json
date-meta: '2020-10-23'
header-includes: "<!--\nManubot generated metadata rendered from header-includes-template.html.\nSuggest improvements at https://github.com/manubot/manubot/blob/master/manubot/process/header-includes-template.html\n-->\n<meta name=\"dc.format\" content=\"text/html\" />\n<meta name=\"dc.title\" content=\"Automatic workflow for the analysis of large batches of micro-tomographic scans of human teeth\" />\n<meta name=\"citation_title\" content=\"Automatic workflow for the analysis of large batches of micro-tomographic scans of human teeth\" />\n<meta property=\"og:title\" content=\"Automatic workflow for the analysis of large batches of micro-tomographic scans of human teeth\" />\n<meta property=\"twitter:title\" content=\"Automatic workflow for the analysis of large batches of micro-tomographic scans of human teeth\" />\n<meta name=\"dc.date\" content=\"2020-10-23\" />\n<meta name=\"citation_publication_date\" content=\"2020-10-23\" />\n<meta name=\"dc.language\" content=\"en-US\" />\n<meta name=\"citation_language\" content=\"en-US\" />\n<meta name=\"dc.relation.ispartof\" content=\"Manubot\" />\n<meta name=\"dc.publisher\" content=\"Manubot\" />\n<meta name=\"citation_journal_title\" content=\"Manubot\" />\n<meta name=\"citation_technical_report_institution\" content=\"Manubot\" />\n<meta name=\"citation_author\" content=\"David Haberth\xFCr\" />\n<meta name=\"citation_author_institution\" content=\"Institute of Anatomy, University of Bern, Switzerland\" />\n<meta name=\"citation_author_orcid\" content=\"0000-0003-3388-9187\" />\n<meta name=\"twitter:creator\" content=\"@habi\" />\n<meta name=\"citation_author\" content=\"Ruslan Hlushchuk\" />\n<meta name=\"citation_author_institution\" content=\"Institute of Anatomy, University of Bern, Switzerland\" />\n<meta name=\"citation_author_orcid\" content=\"0000-0002-6722-8996\" />\n<meta name=\"citation_author\" content=\"Thomas Gerhard Wolf\" />\n<meta name=\"citation_author_institution\" content=\"Department of Restorative, Preventive and Pediatric Dentistry, School of Dental Medicine, University of Bern, Switzerland\" />\n<meta name=\"citation_author_institution\" content=\"Department of Periodontology and Operative Dentistry, University Medical Center of the Johannes-Gutenberg-University Mainz, Mainz, Germany\" />\n<meta name=\"citation_author_orcid\" content=\"0000-0002-4044-1893\" />\n<link rel=\"canonical\" href=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/\" />\n<meta property=\"og:url\" content=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/\" />\n<meta property=\"twitter:url\" content=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/\" />\n<meta name=\"citation_fulltext_html_url\" content=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/\" />\n<meta name=\"citation_pdf_url\" content=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/manuscript.pdf\" />\n<link rel=\"alternate\" type=\"application/pdf\" href=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/manuscript.pdf\" />\n<link rel=\"alternate\" type=\"text/html\" href=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/v/1e09a5907cd85eadf18c88661eed929f6044fd08/\" />\n<meta name=\"manubot_html_url_versioned\" content=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/v/1e09a5907cd85eadf18c88661eed929f6044fd08/\" />\n<meta name=\"manubot_pdf_url_versioned\" content=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/v/1e09a5907cd85eadf18c88661eed929f6044fd08/manuscript.pdf\" />\n<meta property=\"og:type\" content=\"article\" />\n<meta property=\"twitter:card\" content=\"summary_large_image\" />\n<link rel=\"icon\" type=\"image/png\" sizes=\"192x192\" href=\"https://manubot.org/favicon-192x192.png\" />\n<link rel=\"mask-icon\" href=\"https://manubot.org/safari-pinned-tab.svg\" color=\"#ad1457\" />\n<meta name=\"theme-color\" content=\"#ad1457\" />\n<!-- end Manubot generated metadata -->"
keywords:
- markdown
- publishing
- manubot
lang: en-US
manubot-clear-requests-cache: false
manubot-output-bibliography: output/references.json
manubot-output-citekeys: output/citations.tsv
manubot-requests-cache-path: ci/cache/requests-cache
title: Automatic workflow for the analysis of large batches of micro-tomographic scans of human teeth
...






<small><em>
This manuscript
([permalink](https://habi.github.io/zmk-tooth-cohort-method-manuscript/v/1e09a5907cd85eadf18c88661eed929f6044fd08/))
was automatically generated
from [habi/zmk-tooth-cohort-method-manuscript@1e09a59](https://github.com/habi/zmk-tooth-cohort-method-manuscript/tree/1e09a5907cd85eadf18c88661eed929f6044fd08)
on October 23, 2020.
</em></small>

## Authors



+ **David Haberthür**<sup>✉</sup><br>
    ![ORCID icon](images/orcid.svg){.inline_icon}
    [0000-0003-3388-9187](https://orcid.org/0000-0003-3388-9187)
    · ![GitHub icon](images/github.svg){.inline_icon}
    [habi](https://github.com/habi)
    · ![Twitter icon](images/twitter.svg){.inline_icon}
    [habi](https://twitter.com/habi)<br>
  <small>
     Institute of Anatomy, University of Bern, Switzerland
  </small>

+ **Ruslan Hlushchuk**<sup>☯</sup><br>
    ![ORCID icon](images/orcid.svg){.inline_icon}
    [0000-0002-6722-8996](https://orcid.org/0000-0002-6722-8996)
    · ![GitHub icon](images/github.svg){.inline_icon}
    [RuslanHlushchuk](https://github.com/RuslanHlushchuk)<br>
  <small>
     Institute of Anatomy, University of Bern, Switzerland
  </small>

+ **Thomas Gerhard Wolf**<sup>☯</sup><br>
    ![ORCID icon](images/orcid.svg){.inline_icon}
    [0000-0002-4044-1893](https://orcid.org/0000-0002-4044-1893)<br>
  <small>
     Department of Restorative, Preventive and Pediatric Dentistry, School of Dental Medicine, University of Bern, Switzerland; Department of Periodontology and Operative Dentistry, University Medical Center of the Johannes-Gutenberg-University Mainz, Mainz, Germany
  </small>


<sup>☯</sup>: These authors contributed equally to this work.

<sup>✉</sup>: Corresponding author; Correspondence preferred via [GitHub Issues](https://github.com/habi/zmk-tooth-cohort-method-manuscript/issues). Otherwise, send a message to <haberthuer@ana.unibe.ch>.

## Abstract {.page_break_before}

Micro-CT is a powerful tool to analyze and visualize the internal morphology of human permanent teeth.
It is increasingly used for investigation of epidemiological questions to provide the dentist with necessary information that is prerequisite for successful endodontic treatment.
The aim of the present paper was to propose an automated image processing method to automate parts of the work needed to fully describe the internal morphology of human permanent teeth.
104 human teeth were scanned on a high-resolution micro-CT using an automatic specimen changer.
Python code in a Jupyter notebook was used to verify and to process the scans and to prepare the datasets for description of the internal morphology and to measure the apical region of the tooth.
The presented method offers an easy, non-destructive, rapid and efficient approach to scan, check and preview micro-computer tomographic datasets of a large number of teeth.
It is a helpful tool for the detailed description and characterization of the internal morphology of human permanent teeth using automated segmentation by means of micro-CT with full reproducibility and high standardization.

## Keywords

- Automated segmentation
- Biomedical image analysis
- Internal tooth morphology
- Micro-CT
- Physiological foramen geometry
- Root canal configuration

## Introduction {.page_break_before}

Successful endodontic treatments require a precise knowledge of the external and internal morphology of the teeth [@doi:10.1016/0030-4220\(84\)90085-9].
For both surgical and non-surgical interventions it is necessary to know both the complex three-dimensional root canal system with its configurations as well as the details of the apical region of the tooth.
This knowledge is necessary to select the correct instruments and materials and thus make important treatment decisions.
It also helps to avoid errors that can occur during various steps of clinical endodontic treatment, such as preparation of the access cavity, rinsing, shaping and filling of the root canal system [@doi:10.1016/j.joen.2006.02.007].
The errors include, for example, frequently occurring perforations during trepanation or failure in preparing the root canals.
A detailed description and understanding of the root canal system are essential for the clinical practitioner.
Nowadays, in the literature there are numerous imaging methods for the morphological description of teeth, such as clearing technique [@doi:10.4103/2278-9626.126215], optical microscopy [@doi:10.4067/s0717-95022014000200048], two-dimensional radiography, scanning electron microscopy, or three-dimensional imaging techniques such as cone beam computer tomography and micro-computed tomography (micro-CT) [@doi:10.1016/j.joen.2020.03.002].

Micro-CT imaging is a method to non-destructively study objects of interest, namely biomedical samples at high resolution, i.e. in the micrometer range.
Micro-CT imaging is well suited for the three-dimensional (3D) investigation of teeth since it needs no specialized sample preparation in contrast to what is often needed to image soft tissue samples [@doi:10.1111/jmi.12013; @doi:10.1016/j.vph.2018.09.003; @doi:10.1109/tbme.2014.2317554].
Combined with software rendering it is a non-destructive, high-resolution, 3D imaging technique that is able to precisely depict small morphological structures (\<20 µm) in teeth and thus provides information that is superior to other methods in *ex vivo* research and has therefore been suggested as a gold standard [@doi:10.14219/jada.archive.2006.0091; @doi:10.1111/iej.12593; @doi:10.1046/j.1365-2591.1999.00204.x].
Micro-CT is increasingly used for investigation of epidemiological questions to provide the dentist with necessary information that is a prerequisite for successful endodontic treatment [@doi:10.1016/j.joen.2019.11.006.; @doi:10.1016/j.joen.2020.08.012; @doi:10.1007/s00784-020-03284-7].

Clinically relevant for the dentist are, on the one hand, the root canal configuration and, on the other hand, the physiological procedure.
Both parameters are important, as they give information about the expected anatomical conditions and the size of the physiological foramen for clinical purposes.
Due to the relatively low cost and batch-scanning capabilities of recent desktop micro-CT systems large cohorts of teeth can be scanned in a relatively short time, generating terabytes of raw data.
Such a large amount of data necessitates an efficient, reproducible and automated framework to analyze such large batches of tomographic datasets.
Previous works have already analyzed large batches of teeth, but only for a small region of each tooth [@doi:10.1016/j.joen.2018.10.019; @doi:10.1016/j.joen.2009.04.020], with considerable manual work for the segmentation of the tooth [@doi:/10.1016/j.joen.2019.11.006; @doi:10.1016/j.joen.2015.09.007].
The hereby presented protocol provides an automated segmentation method for *ex vivo* research on extracted human teeth using a four-digit root canal configuration code as well as detection and measurement of the physiological foramen parameters.
We achieve this by using free and open-source software [@isbn:978-0262062466], the fact which we believe to considerably increase the potential impact of our work, e.g. making it widely available for collaborators and other users.


## Materials & Methods {.page_break_before}

### Teeth

Describe how the teeth have been collected and stored.

### X-ray microtomography

After preparation of the teeth, the 104 samples were imaged on a Bruker SkyScan 1272 high-resolution microtomography machine (Control software version 1.1.19, Bruker microCT, Kontich, Belgium).
To facilitate the scanning of this large batch of samples, we used the automatic sample changer to enable us to scan batches of 16 teeth without manual intervention.
In addition to the sample changer, the machine is equipped with a Hamamatsu L11871_20 X-ray source and a XIMEA xiRAY16 camera.

We used a custom-made sample-holder to scan the teeth on the sample changer.
The sample holder has been 3d printed and is freely available online (https://git.io/JJbAZ) as part of a library of sample holders [@doi:10.5281/zenodo.2587555].

The X-ray source was set to a tube voltage of 80.0 kV and a tube current of 125.0 µA, the x-ray spectrum was filtered by 1mm of Aluminium prior to incidence onto the sample.
For each sample, we recorded a set of either 4 or 5 stacked scans overlapping the sample height, each stack was recorded with 482 projections of 1632 x 1092 pixels at every 0.4° over a 180° sample rotation.
Every single projection was exposed for 950 ms, 3 projections were averaged to one to greatly reduce image noise.
This resulted in a scan time of approximately 40 minutes per stack and between 2 hours and 40 minutes to 3 hours and 15 minutes per sample.
In total, we thus scanned for approximately 13 days.
The projection images were then subsequently reconstructed into a 3D stack of axial images spanning the whole length of each tooth with NRecon (Version 1.7.4.6, Bruker microCT, Kontich Belgium) using a ring artifact correction of 14.
The whole process resulted in datasets with an isometric voxel size of 10.0 µm.

We recorded on average 8.17 GB of raw data for each tooth, totalling to 849.59 GB for all the 104 teeth.

### Image analysis

Already during scanning the first items of the batch, we wrote a Jupyter [@doi:10.3233/978-1-61499-649-1-87] notebook with Python code which permitted to check the already performed scans as soon as they were reconstructed. Reruns of the notebook added newly scanned and reconstructed teeth to the analysis, facilitating preliminary checks and analysis of already scanned teeth.
The notebook we used for the analysis presented in this manuscript is freely available online [@doi:10.5281/zenodo.3999402].
The important steps of the analysis steps are described in detail below.

#### Preparation

In a first step we extract all wanted parameters from the log file of each scan to store into a Pandas [@doi:10.25080/Majora-92bf1922-00a] dataframe for comparing and double-checking all the necessary scan parameters of each tooth scan with all the others.
Afterwards, we loaded the preview image of each scan and then generated an overview image of all the scans (see Figure @fig:overviews).

![Overview images for each of all the teeth we scanned.
  It is immediately visible that several teeth slipped down in the holder.
  Since we were particularly interested in the bottom part of the teeth this poses no problem for further analysis.
  The irregular illumination stems from the rudimentary stitching process and is not visible in the reconstructed slices.](images/ScanOverviews.png){#fig:overviews}

And here's some more text.



## Introduction {.page_break_before}

Hereby we present a method to efficiently and reproducibly analyze large batches of teeth.


## Conclusions {.page_break_before}

The presented method offers an efficient approach to scan, check and preview micro-computer tomographic datasets of a large amount of teeth.
We describe a helpful, free and open-source software tool to prepare datasets for precise description and characterization of the internal morphology of human permanent teeth using automated segmentation of features of interest.
Due to the high reproducibility and standardization of the presented method, datasets of large cohorts and populations can be investigated easily and rapidly.

## Acknowledgements

We thank Oleksiy-Zakhar Khoma (Institute of Anatomy, Unversity of Bern, Switzerland) for designing [the sample holder that we used for scanning the teeth](https://github.com/TomoGraphics/Hol3Drs/blob/master/STL/tooth_holder3.stl).
We thank Jennifer Fazzari (Institute of Anatomy, Unversity of Bern, Switzerland) for proof-reading the manuscript.
We thank Andrea Anderegg and Michael Stiebritz (Department of Restorative, Preventive and Pediatric Dentistry, School of Dental Medicine, University of Bern, Switzerland) and Valentin Djonov (Institute of Anatomy, Unversity of Bern, Switzerland) for their kind support.
This research did not receive any specific grant from funding agencies in the public, commercial, or not-for-profit sectors.

## Contributions

- DH scanned the teeth, wrote the analysis notebook and the original draft of the manuscript.
- RH contributed with discussion during the development of the method and reviewed the manuscript.
- TGW contributed with ideas and discussion for developing the method, discussed the results, edited and reviewed the manuscript.

All authors read and approved the final manuscript.

## Conflict of interest statement

The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.

## References {.page_break_before}

<!-- Explicitly insert bibliography here -->
<div id="refs"></div>
