---
author-meta:
- "David Haberth\xFCr"
- Ruslan Hlushchuk
- Thomas Gerhard Wolf
bibliography:
- content/manual-references.bib
- content/manual-references.json
date-meta: '2022-01-25'
header-includes: "<!--\nManubot generated metadata rendered from header-includes-template.html.\nSuggest improvements at https://github.com/manubot/manubot/blob/master/manubot/process/header-includes-template.html\n-->\n<meta name=\"dc.format\" content=\"text/html\" />\n<meta name=\"dc.title\" content=\"Automated segmentation and description of the internal morphology of human permanent teeth by means of micro-CT\" />\n<meta name=\"citation_title\" content=\"Automated segmentation and description of the internal morphology of human permanent teeth by means of micro-CT\" />\n<meta property=\"og:title\" content=\"Automated segmentation and description of the internal morphology of human permanent teeth by means of micro-CT\" />\n<meta property=\"twitter:title\" content=\"Automated segmentation and description of the internal morphology of human permanent teeth by means of micro-CT\" />\n<meta name=\"dc.date\" content=\"2022-01-25\" />\n<meta name=\"citation_publication_date\" content=\"2022-01-25\" />\n<meta name=\"dc.language\" content=\"en-US\" />\n<meta name=\"citation_language\" content=\"en-US\" />\n<meta name=\"dc.relation.ispartof\" content=\"Manubot\" />\n<meta name=\"dc.publisher\" content=\"Manubot\" />\n<meta name=\"citation_journal_title\" content=\"Manubot\" />\n<meta name=\"citation_technical_report_institution\" content=\"Manubot\" />\n<meta name=\"citation_author\" content=\"David Haberth\xFCr\" />\n<meta name=\"citation_author_institution\" content=\"Institute of Anatomy, University of Bern, Bern, Switzerland\" />\n<meta name=\"citation_author_orcid\" content=\"0000-0003-3388-9187\" />\n<meta name=\"twitter:creator\" content=\"@habi\" />\n<meta name=\"citation_author\" content=\"Ruslan Hlushchuk\" />\n<meta name=\"citation_author_institution\" content=\"Institute of Anatomy, University of Bern, Bern, Switzerland\" />\n<meta name=\"citation_author_orcid\" content=\"0000-0002-6722-8996\" />\n<meta name=\"citation_author\" content=\"Thomas Gerhard Wolf\" />\n<meta name=\"citation_author_institution\" content=\"Department of Restorative, Preventive and Pediatric Dentistry, School of Dental Medicine, University of Bern, Bern, Switzerland\" />\n<meta name=\"citation_author_institution\" content=\"Department of Periodontology and Operative Dentistry, University Medical Center of the Johannes-Gutenberg-University Mainz, Mainz, Germany\" />\n<meta name=\"citation_author_orcid\" content=\"0000-0002-4044-1893\" />\n<link rel=\"canonical\" href=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/\" />\n<meta property=\"og:url\" content=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/\" />\n<meta property=\"twitter:url\" content=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/\" />\n<meta name=\"citation_fulltext_html_url\" content=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/\" />\n<meta name=\"citation_pdf_url\" content=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/manuscript.pdf\" />\n<link rel=\"alternate\" type=\"application/pdf\" href=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/manuscript.pdf\" />\n<link rel=\"alternate\" type=\"text/html\" href=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/v/6a1e2d41ddf30e826b75e71aab536fa3b5a28191/\" />\n<meta name=\"manubot_html_url_versioned\" content=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/v/6a1e2d41ddf30e826b75e71aab536fa3b5a28191/\" />\n<meta name=\"manubot_pdf_url_versioned\" content=\"https://habi.github.io/zmk-tooth-cohort-method-manuscript/v/6a1e2d41ddf30e826b75e71aab536fa3b5a28191/manuscript.pdf\" />\n<meta property=\"og:type\" content=\"article\" />\n<meta property=\"twitter:card\" content=\"summary_large_image\" />\n<meta property=\"og:image\" content=\"https://github.com/habi/zmk-tooth-cohort-method-manuscript/raw/6a1e2d41ddf30e826b75e71aab536fa3b5a28191/content/images/Tooth045.manubot.png\" />\n<meta property=\"twitter:image\" content=\"https://github.com/habi/zmk-tooth-cohort-method-manuscript/raw/6a1e2d41ddf30e826b75e71aab536fa3b5a28191/content/images/Tooth045.manubot.png\" />\n<link rel=\"icon\" type=\"image/png\" sizes=\"192x192\" href=\"https://manubot.org/favicon-192x192.png\" />\n<link rel=\"mask-icon\" href=\"https://manubot.org/safari-pinned-tab.svg\" color=\"#ad1457\" />\n<meta name=\"theme-color\" content=\"#ad1457\" />\n<!-- end Manubot generated metadata -->"
keywords:
- markdown
- publishing
- manubot
lang: en-US
manubot-clear-requests-cache: false
manubot-output-bibliography: output/references.json
manubot-output-citekeys: output/citations.tsv
manubot-requests-cache-path: ci/cache/requests-cache
title: Automated segmentation and description of the internal morphology of human permanent teeth by means of micro-CT
...




A published version of this manuscript is available at <https://doi.org/10.1186/s12903-021-01551-x>.
The version of the manuscript you see here [has been updated](https://github.com/habi/zmk-tooth-cohort-method-manuscript/compare/6d0a6402c44cb9745875171d2d33c37b4d7fe4be...6a1e2d41ddf30e826b75e71aab536fa3b5a28191) with minor corrections compared to the submitted version.
These errors have been corrected in the proof-stage at BMC Oral Health and are *not* present in the published version.


<small><em>
This manuscript
([permalink](https://habi.github.io/zmk-tooth-cohort-method-manuscript/v/6a1e2d41ddf30e826b75e71aab536fa3b5a28191/))
was automatically generated
from [habi/zmk-tooth-cohort-method-manuscript@6a1e2d4](https://github.com/habi/zmk-tooth-cohort-method-manuscript/tree/6a1e2d41ddf30e826b75e71aab536fa3b5a28191)
on January 25, 2022.
</em></small>

## Authors



+ **David Haberthür**<sup>✉</sup><br>
    ![ORCID icon](images/orcid.svg){.inline_icon}
    [0000-0003-3388-9187](https://orcid.org/0000-0003-3388-9187)
    · ![GitHub icon](images/github.svg){.inline_icon}
    [habi](https://github.com/habi)
    · ![Twitter icon](images/twitter.svg){.inline_icon}
    [habi](https://twitter.com/habi)<br>
  <small>
     Institute of Anatomy, University of Bern, Bern, Switzerland
  </small>

+ **Ruslan Hlushchuk**<sup>☯</sup><br>
    ![ORCID icon](images/orcid.svg){.inline_icon}
    [0000-0002-6722-8996](https://orcid.org/0000-0002-6722-8996)
    · ![GitHub icon](images/github.svg){.inline_icon}
    [RuslanHlushchuk](https://github.com/RuslanHlushchuk)<br>
  <small>
     Institute of Anatomy, University of Bern, Bern, Switzerland
  </small>

+ **Thomas Gerhard Wolf**<sup>☯</sup><br>
    ![ORCID icon](images/orcid.svg){.inline_icon}
    [0000-0002-4044-1893](https://orcid.org/0000-0002-4044-1893)<br>
  <small>
     Department of Restorative, Preventive and Pediatric Dentistry, School of Dental Medicine, University of Bern, Bern, Switzerland; Department of Periodontology and Operative Dentistry, University Medical Center of the Johannes-Gutenberg-University Mainz, Mainz, Germany
  </small>


<sup>✉</sup>: Corresponding author; Correspondence preferred via [GitHub Issues](https://github.com/habi/zmk-tooth-cohort-method-manuscript/issues). Otherwise, send a message to <haberthuer@ana.unibe.ch>.

<sup>☯</sup>: These authors contributed equally to this work.


## Abstract {.page_break_before}

High-resolution micro-computed tomography is a powerful tool to analyze and visualize the internal morphology of human permanent teeth.
It is increasingly used for investigation of epidemiological questions to provide the dentist with the necessary information required for successful endodontic treatment.
The aim of the present paper was to propose an image processing method to automate parts of the work needed to fully describe the internal morphology of human permanent teeth.

One hundred and four human teeth were scanned on a high-resolution micro-CT scanner using an automatic specimen changer.
Python code in a Jupyter notebook was used to verify and process the scans, prepare the datasets for description of the internal morphology and to measure the apical region of the tooth.

The presented method offers an easy, non-destructive, rapid and efficient approach to scan, check and preview tomographic datasets of a large number of teeth.
It is a helpful tool for the detailed description and characterization of the internal morphology of human permanent teeth using automated segmentation by means of micro-CT with full reproducibility and high standardization.


## Keywords

- Automated segmentation
- Biomedical image analysis
- Internal tooth morphology
- Micro-CT
- Physiological foramen geometry
- Root canal configuration


## Introduction {.page_break_before}

Successful endodontic treatments require a precise knowledge of the external and internal morphology of the teeth [@doi:10/c9wr8n].
For both surgical and non-surgical interventions it is necessary to know both the complex three-dimensional root canal system with its configurations as well as the details of the apical region of the tooth.
This knowledge is necessary to select the correct instruments and materials, thus aiding in important treatment decisions.
It also helps to avoid errors that can occur during various steps of clinical endodontic treatment, such as preparation of the access cavity, rinsing, shaping and filling of the root canal system [@doi:10.1016/j.joen.2006.02.007].
For example, these errors can include perforations during trepanation or failure in preparing the root canals.
A detailed description and understanding of the root canal system is, therefore, essential for the clinical practitioner.
At present, there are numerous imaging methods for the morphological description of teeth presented in the literature, including the clearing technique [@doi:10.4103/2278-9626.126215], optical microscopy [@doi:10.4067/s0717-95022014000200048], two-dimensional radiography, scanning electron microscopy, or three-dimensional imaging techniques such as cone beam computer tomography and micro-computed tomography (micro-CT) [@doi:10.1016/j.joen.2020.03.002].

Micro-computed tomography (micro-CT) is a method to non-destructively image the internals of objects of interest, namely biomedical samples at high resolution, i.e. in the micrometer range.
Micro-CT imaging is well suited for the three-dimensional (3D) investigation of teeth since it needs no specialized sample preparation in contrast to what is often needed to image soft tissue samples [@doi:10.1111/jmi.12013; @doi:10.1016/j.vph.2018.09.003; @doi:10.1109/tbme.2014.2317554].
Combined with software rendering, it is a non-destructive, high-resolution, 3D imaging technique that can precisely depict small morphological structures (\< 20 µm) in teeth thus making it superior to other *ex vivo* methods and therefore, suggested as a gold standard in the field [@doi:10.14219/jada.archive.2006.0091; @doi:10.1111/iej.12593; @doi:10.1046/j.1365-2591.1999.00204.x].
Micro-CT is increasingly used for investigation of epidemiological questions to provide the dentist with necessary information that is a prerequisite for successful endodontic treatment [@doi:10.1016/j.joen.2019.11.006; @doi:10.1016/j.joen.2020.08.012; @doi:10.1007/s00784-020-03284-7].

Clinically relevant for the dentist are both the root canal configuration and the physiological procedure.
Both parameters are important, as they give information about the expected anatomical conditions and the size of the physiological foramen for clinical purposes.
Due to the batch-scanning capabilities of recent desktop micro-CT systems large cohorts of teeth can be efficiently scanned with minimal manual intervention, generating terabytes of raw data for further analysis.
Such a large amount of data necessitates an efficient, reproducible and automated framework to analyze such large tomographic datasets.
Previous works have already analyzed large batches of teeth, but only for a small region of each tooth [@doi:10.1016/j.joen.2018.10.019; @doi:10.1016/j.joen.2009.04.020] and with a considerable degree of manual input required for tooth segmentation [@doi:10.1016/j.joen.2019.11.006; @doi:10.1016/j.joen.2015.09.007].
The hereby presented protocol provides an automated segmentation method for *ex vivo* research on extracted human teeth using a four-digit root canal configuration code as well as detection and measurement of the physiological foramen parameters.
We achieved this by using free and open-source software [@isbn:978-0262062466], considerably increasing the impact and availability of our method for collaborators and other users in the field.


## Materials & Methods {.page_break_before}

The whole workflow performed for this manuscript is depicted in Figure @fig:workflow.
Details of each step are explained in this section.

![Workflow of steps performed for this manuscript.](images/workflow.png){#fig:workflow}

### Tooth selection

A total of 104 extracted human permanent mandibular canines were collected from university medical centers in southwest Germany and Switzerland.
All included teeth were extracted for reasons unrelated to the study and are so-called excess material.
The teeth were single-rooted and investigated according to their morphological criteria.
Inclusion criteria for teeth selection were complete coronal and root development and the absence of root fracture and resorption, endodontic treatment no radicular caries.
Calculus as well as hard and soft tissue was removed as well as possible using an ultrasonic scaler.
Afterwards, the teeth were placed for one hour in a 3% hydrogen peroxide ultrasonic bath and then stored in 70% ethanol [@doi:10.1016/j.joen.2020.03.002; @doi:10.1016/j.joen.2019.11.006; @doi:10.1016/j.joen.2018.10.019; @doi:10.1016/j.joen.2015.09.007; @doi:10.1038/ijos.2017.29].

### Micro-CT-based morphological analysis

The 104 samples were imaged on a [Bruker SkyScan 1272](https://www.bruker.com/products/microtomography/micro-ct-for-sample-scanning/skyscan-1272/overview.html) high-resolution micro-CT machine (Control software version 1.1.19, [Bruker microCT](https://www.bruker.com/products/microtomography.html), Kontich, Belgium).
To facilitate the scanning of this large batch of samples, we used the automatic sample changer to enable us to scan batches of 16 teeth without any intervention.
In addition to the sample changer, the machine is equipped with a Hamamatsu L11871\_20 X-ray source and a XIMEA xiRAY16 camera.
We used a custom-made sample-holder to scan the teeth on the sample changer.
The sample holder was 3D-printed on a [Form 2](https://formlabs.com/3d-printers/form-2/) desktop stereolithography printer ([Formlabs](https://formlabs.com/), Somerville, Massachusetts, USA) and is freely available online ([git.io/JJbAZ](https://git.io/JJbAZ)) as part of a library of sample holders [@doi:10.5281/zenodo.2587555].

The X-ray source was set to a tube voltage of 80.0 kV and a tube current of 125.0 µA, the x-ray spectrum was filtered by 1mm of Aluminium.
For each sample, depending on the sample height, we recorded a set of either 4 or 5 stacked scans overlapping its height.
Each stack was recorded with 482 TIFF projections of 1632 x 1092 pixels at every 0.4° over a 180° sample rotation.
Every single projection was exposed for 950 ms and 3 projections were averaged to greatly reduce image noise.
This resulted in a scan time of approximately 40 minutes per stack and between 2 hours and 40 minutes to 3 hours and 15 minutes per sample.
In total, we thus scanned for approximately 13 days.
On average, we recorded 7.88 GB of raw data for each tooth, totaling 819 GB for all 104 teeth.
The obtained projection images were subsequently reconstructed into a 3D stack of axial PNG images spanning the whole length of each tooth with NRecon (Version 1.7.4.6, Bruker microCT, Kontich Belgium) using a ring artifact correction of 14.
The whole process resulted in datasets with an isometric voxel size of 10.0 µm.
The teeth were all slightly different in height and on average we had about 2700 reconstructions per teeth and a total of approximately 280000 files for all teeth.
The reconstructed PNG slices per tooth are on average 3.13 GB in size, totaling approximately 326 GB for all 104 teeth.

### Image processing

We wrote a *Jupyter* (version 4.5.0) [@https://eprints.soton.ac.uk/403913/] notebook with *Python* code (version 3.7.3) which allowed for scans to be checked as soon as they were reconstructed during scanning of the first items in the batch.
Re-runs of the notebook added newly scanned and reconstructed teeth to the analysis, facilitating preliminary checks and analysis of already scanned teeth.
The notebook used for the analysis presented in this manuscript is freely available online [@doi:10.5281/zenodo.3999402].
The important steps of the analysis steps are described in detail below.

#### Preparation

In a first step we extracted all necessary parameters from the log file of each scan to store into a *Pandas* (version 0.25.1) [@doi:10.25080/Majora-92bf1922-00a] dataframe for comparison and verification of all the necessary scan parameters of each scanned tooth with all the others.
Afterwards, the preview image of each scan was loaded and an overview image of all the scans was generated (see Figure @fig:overviews, in which we show a randomly selected subset of the whole tooth cohort).

![Overview images for a random selection of 24 of the 104 teeth.
  It is immediately visible that several teeth slipped down in the holder.
  Since we were particularly interested in the bottom part of the teeth (top in this view) this poses no problem for further analysis.
  The irregular brightness along the vertical axis stems from the rudimentary stitching process of the overview images and is not visible in the reconstructed slices.](images/ScanOverviews.png){#fig:overviews}

We used *Dask* (version 2.5.2) [@dask] to read the set of axial reconstruction PNG slices for each sample.
The reconstructions were stored on disk in the *Zarr* storage format [@doi:10.5281/zenodo.3773451], an efficient, chunked and compressed array representation of the single images.
The zarr-representation of the reconstructions were used for further analysis and had a total size of 330 GB on disk.

#### Dataset cropping

To reduce the size of the data on disk, we cropped the datasets to their minimal amount, i.e. to the smallest cuboid encompassing the full tooth.
This was done by segmenting the dataset into tooth and background using a common, fixed gray-value threshold for all datasets.
We denoised this refined dataset by discarding speckles with a volume smaller than 1000 voxels with the [`remove_small_object`](https://scikit-image.org/docs/dev/api/skimage.morphology.html\#skimage.morphology.remove_small_objects) function of *scikit-image* (version 0.15.0) [@doi:10.7717/peerj.453] and subsequently isolated the biggest object with the [`find_objects`](https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.find_objects.html) function of *SciPy* (version 1.3.1) [@doi:10.1038/s41592-019-0686-2].
The extent of this largest object represents the smallest possible region in which the tooth is contained.
By removing the empty parts of each three-dimensional dataset containing no information about the teeth, we reduced the size of all datasets nearly three-fold, to approximately 1.11 GB per sample, or a total of 115 GB for all 104 teeth thus facilitating further handling of the data.

#### Overview images for visual examination

For quick visual assessment of each of the tooth scans, we extracted overview images for each tooth.
After cropping the datasets, we extracted the middle slices and generated the maximum intensity projection (MIP) for each of the anatomical planes [@https://w.wiki/_K2r].
Since the teeth were scanned rotationally invariant, the two anatomical planes along the long axis of the tooth (coronal and sagittal) are not related to the real tooth anatomy and simply correspond to the respective direction in the tomographic dataset.

#### Root canal extraction

It was of paramount importance for the analysis to visualize the root canal system inside the tooth.
We thus wrote a function to extract the root canal based on its appearance in the axial slices of the datasets.
By using an automated Otsu thresholding implemented in *scikit-image* [@doi:10.7717/peerj.453] on each slice of the datasets, we separated the tooth from the background.
By inversion of the image we select all that is not tooth.
From this, we remove all the pixels that touch the image border i.e. the air surrounding the tooth, with the [`clear_border`](https://scikit-image.org/docs/dev/api/skimage.segmentation.html\#skimage.segmentation.clear_border) function.
We further removed speckles with an area of less than 64 pixels and closed holes with an area smaller than 100 pixels in the remaining image data to extract the root canal system from inside the tooth (with the [`remove_small_objects`](https://scikit-image.org/docs/dev/api/skimage.morphology.html\#skimage.morphology.remove_small_objects) and
[`remove_small_holes`](https://scikit-image.org/docs/dev/api/skimage.morphology.html\#skimage.morphology.remove_small_holes) functions, respectively).
Datasets of the root canal have again been written to disk for further analysis and display.
Since these are binarized datasets, we were able to store them on disk very efficiently, with the total size of all 104 datasets containing only the root canal system being only 309 MB.
Display of the datasets for visual assessment was done with *itkwidgets* (version 0.21.1) [@doi:10.5281/zenodo.3974615], permitting a basic 3D visualization of each tooth for quality control (an example is shown in Figure @fig:3ditkwidgets).

![Basic 3D visualization directly from our preparation and analysis pipeline.
  This tooth is interesting as it features a 1-2-2/2 root canal configuration as defined by Briseño et al. [@doi:10.1016/j.joen.2015.09.007].
  The whole tooth has a length of 2.39 cm.](images/Tooth045.itkwidgets.png){#fig:3ditkwidgets}

#### Root canal system classification

To facilitate the global characterization of the tooth, we extracted slices at four defined locations along the tooth.
These slices, located at the border between enamel and dentin (EDB), the bottom of the tooth and equidistantly between, were then used to describe the root canal configuration (as extracted above in subsection [Root canal extraction]) with a 4-digit system and to assess the number of main foramina, both according to a previously proposed method [@doi:10.1016/j.joen.2015.09.007].
The three-dimensional location of these extracted slices is shown in Figure @fig:3dmevislab.

![Three-dimensional visualization of tooth sample 045.
  This tooth is interesting as it features a 1-2-2/2 root canal configuration as defined by Briseño et al. [@doi:10.1016/j.joen.2015.09.007].
  The extracted root canal is shown in red, the tooth itself is shown semitransparent.
  The four slices which were automatically extracted based on the enamel-dentin border are also visualized semitransparent in their correct 3D position.
  The whole tooth has a length of 2.39 cm.
  A [video of the 3D visualization is found in the supplementary materials](https://github.com/habi/zmk-tooth-cohort-method-manuscript/blob/master/content/images/tooth045.mp4?raw=true) of this manuscript.](images/Tooth045.MeVisLab.png){#fig:3dmevislab}

We calculated the brightness value along the longest axis of the tooth followed by smoothing of the curve using a [locally weighted scatterplot smoothing](https://www.statsmodels.org/devel/generated/statsmodels.nonparametric.smoothers_lowess.lowess.html) implemented in the *statsmodels* library (version 0.10.1) [@statsmodels].
By finding the maximal derivation of this curve with *NumPy* (version 1.17.2) [@doi:10.1109/mcse.2011.37], we were easily able to detect the EDB (see the two left panels in Figure @fig:briseno).
For small regions of 400 µm around these four equidistant slices to be extracted for the Briseño classification, we wrote the minimum gray value to the resulting image.
As a consequence this increased the visible noise for these regions but greatly helped to classify accessory canals in these regions (as shown in the four right panels in Figure @fig:briseno).
These regions and an overview of the tooth were written to an image for each sample to help with an efficient manual characterization of each tooth without manually looking for the correct axial reconstruction (see Figure @fig:extractedslices).

![Slice extraction for characterization of a tooth.
  This tooth features a 1-1-1/1 root canal configuration as defined by Briseño et al. [@doi:10.1016/j.joen.2015.09.007].
  The blue line in the two leftmost panels shows the gray value plot along the longest tooth axis, the orange line shows the smoothed plot.
  Based on the largest derivation we detect the enamel-dentin border at slice 911 of this dataset.
  Based on the bottom around slice 2341 we extracted the equidistant slices in-between.](images/Tooth036.ExtractedSlices.png){#fig:extractedslices}

To further aid the manual classification of each tooth we used the [`label`](https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.label.html) function of the *SciPy* library to count the root canal or root canals in each extracted slice and thus automatically extract the Briseño classification [@doi:10.1016/j.joen.2015.09.007] for each tooth.
An example of such an automated extraction (for the same tooth as shown in Figure @fig:extractedslices) is shown in Figure @fig:briseno.

![Automatic Briseño classification [@doi:10.1016/j.joen.2015.09.007] of the extracted tooth slices.
  This tooth features a 1-1-1/1 root canal configuration as also seen in Figure @fig:extractedslices.
  All automatically extracted classifications are only extracted to aid a the skilled observator fully describing the teeth since the simple automatic classification does not correctly classify each tooh in the whole cohort.](images/Tooth036.Briseno.png){#fig:briseno}

### Analysis of the physiological foramen geometry

The apical foramen of the teeth was evaluated as previously described [@doi:10.1038/ijos.2017.29] by assessing the bottom part of each tooth using *Fiji* (version 1.53c) [@doi:10.1038/nmeth.2019] to scroll through the stack of images and measure the diameter of the physiological and anatomical foramen as well as the distance between the physiological and anatomical foramina.
The physiological (main) foramen was defined as one with a diameter of 0.20 mm or more.
Foramina with diameters smaller than 0.20 mm were defined as accessory ones [@doi:10.1038/ijos.2017.29].
Since we have extracted the root canal for each tooth, we can easily calculate its diameter at each point, that is, exactly calculate the exact Euclidean distance transform (EDT) where each 3D voxel of the root canal is labeled with its distance relative to the background (wall of the canal).
We used the [`morphology.distance_transform_edt`](https://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.ndimage.morphology.distance_transform_edt.html) function of the *SciPy* library for this.
To aid the assessment of the geometry of the physiological foramen, we extracted the bottom 3.5 mm part of each tooth, merged the reconstructed slices of the data with the calculated EDT from the root canal and wrote this data to disk reformatted into sagittal
slices.
In such a way, the radius of the largest sphere fitted into the root canal system at each point can easily be read off the image upon visual examination.
The use of the *Dask* library facilitated efficient reformatting of the datasets and writing them to disk.


## Results and Discussion {.page_break_before}

High resolution datasets of large batches of teeth were acquired in an efficient manner with minimized operator effort due to the batch-scanning abilities of the desktop micro-CT scanner.
The acquired datasets were imaged at a voxel size (10 μm) permitting the analysis of the finest features of interest in the teeth.

The batch-characteristics of the proposed dataset preparation and analysis method makes it easy and efficient to begin processing tooth datasets as scanning of a large batch of teeth is already underway.
Our script facilitates short turnaround time for feedback on single scans in the batch, since samples can be processed by the script as soon as they are reconstructed and while other teeth are still being scanned or waiting to be scanned.
Cropping the datasets with a simple algorithm - as described in subsection [Dataset cropping] above - greatly reduces the size of the datasets on disk.

The proposed method is completely devoid of any manual input, all the datasets present on disk are prepared and analyzed automatically.
This allows for a highly reproducible and completely unbiased analysis.
Previous studies [@doi:10.1016/j.joen.2020.08.012; @doi:10.1016/j.joen.2020.03.001] have analyzed teeth with a precisely defined manual protocol which necessitated several, accurately performed manual steps, increasing the likelihood of operator error being introduced.
This is avoided in the method presented here.

Several teeth contained metal fillings (amalgam) in the crown area, which are difficult to penetrate with the X-ray source available to us.
A simple thresholding leads to artefacts that extended to the border of the original dataset, thus for these datasets, there were no gains in disk space.
Since the cropping part only influences the final size of the dataset on disk and not the extraction of the root canal system from the tooth, it is only of minor concern.
Additionally, the implants or metal fillings in several teeth made it impossible to automatically detect the enamel-dentin border.
If an implant or filling is present in the tooth, the largest derivation in the gray value profile along the tooth is situated at the bottom end of the implant.
The function to extract the EDB was implemented in a way that a manual extraction of the border and the corresponding slices along the tooth axis was possible.

The reformatting of only the bottom part of the tooth greatly facilitated the analysis of the geometry of the physical foramen of each tooth.
While all reconstructions of a single tooth are more than 1 GB in size, these partial datasets are only around 22 MB per tooth.
In total, the bottom 3.5 mm of all 104 teeth occupied only 2.3 GB of disk space, making further assessment of the foramen easily and efficiently possible on a standard office laptop.

The non-destructively acquired three-dimensional datasets of the tooth can also be used for additional analysis of tooth morphology, akin to the process outlined by Di Angelo et al. [@doi:10.1016/j.compbiomed.2016.01.018], Peters et al. [@doi:10.1016/j.joen.2015.06.007] or Paqué et al. [@doi:10.1016/j.joen.2009.04.020].
Further work will focus on automatically extracting a description of the physiological foramen which will allow for dentists to gain important information required for a successful root canal treatment.

The hereby presented workflow is based completely on free and open-source software and can therefore be verified independently by any interested reader.
The Jupyter notebook described here is also freely available online [@doi:10.5281/zenodo.3999402].
A copy with two samples from the cohort can be run in your browser without installing any software via *Binder* [@doi:10.25080/majora-4af1f417-011] by [clicking a single button](https://mybinder.org/v2/gh/habi/zmk-tooth-cohort/master?filepath=ToothAnalysis.ipynb) in the [README file](https://github.com/habi/zmk-tooth-cohort/blob/master/README.md) of the [project repository](https://github.com/habi/zmk-tooth-cohort/).


## Conclusions {.page_break_before}
The presented method offers an efficient approach to scan, check and preview micro-computer tomographic datasets of many teeth.
We describe a helpful, free and open-source software tool to prepare datasets for precise description and characterization of the internal morphology of human permanent teeth using automated segmentation of features of interest.
Due to the high reproducibility and standardization of the presented method, datasets of large cohorts and populations can be investigated easily and rapidly.

A follow-up study will fully describe the cohort mentioned in this manuscript and use the hereby presented method for describing the teeth in detail.


## Declarations {.page_break_before}

### Ethics approval, consent to participate and consent for publication

The 104 human permanent mandibular canines in this study were collected from university medical centers in southwest Germany and Switzerland.
All included teeth were extracted for reasons unrelated to the study and are so-called excess material.
The teeth were used under irreversibly anonymized conditions and in accordance with the Federal Act on Research involving Human Beings (Human Research Act [@https://www.admin.ch/opc/en/classified-compilation/20061313/index.html]).
All donors were adults and gave written informed consent for research purposes.
This makes an ethics approval unnecessary for the purpose of this investigation.

### Availability of data and materials

Two tooth datasets are available to download in the GitHub repository with the analysis notebook: https://github.com/habi/zmk-tooth-cohort [@doi:10.5281/zenodo.3999402].
The other datasets used for the current study are available from the corresponding author on reasonable request.

### Competing interests

The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.

### Funding

This research did not receive any specific grant from funding agencies in the public, commercial, or not-for-profit sectors.

### Authors' contribution

DH scanned the teeth, wrote the analysis notebook and the original draft of the manuscript.
RH contributed with discussion during the development of the method and reviewed the manuscript.
TGW contributed with ideas and discussion for developing the method, discussed the results, edited and reviewed the manuscript.
All authors read and approved the final manuscript.

### Acknowledgments

We thank Oleksiy-Zakhar Khoma (Institute of Anatomy, University of Bern, Switzerland) for designing [the sample holder that we used for scanning the teeth](https://github.com/TomoGraphics/Hol3Drs/blob/master/STL/tooth_holder3.stl).
We thank Jennifer Fazzari (Institute of Anatomy, University of Bern, Switzerland) for proof-reading the manuscript.
We thank Andrea Anderegg and Michael Stiebritz (both Department of Restorative, Preventive and Pediatric Dentistry, School of Dental Medicine, University of Bern, Switzerland) and Valentin Djonov (Institute of Anatomy, University of Bern, Switzerland) for their kind support.


## References {.page_break_before}

<!-- Explicitly insert bibliography here -->
<div id="refs"></div>
